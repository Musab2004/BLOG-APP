<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog Editor</title>
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <link
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
rel="stylesheet"
/>
<!-- Google Fonts -->
<link
href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
rel="stylesheet"
/>
<!-- MDB -->
<link
href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.1/mdb.min.css"
rel="stylesheet"
/>

</head>
<body>
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"> -->

</head>

<header>

  </header>


<body>
 
<div style="margin-top: 10%;">   
   
        <form method="post" id="blogForm" action="{% url 'administrator:createpost' %}" enctype="multipart/form-data">

            <div class="form-group">
              <div class="image-container text-center">
                <!-- Placeholder image -->
                <label for="imageInput"></label>
                <img src="https://mdbootstrap.com/img/new/slides/080.jpg" id="previewImage1" class="img-fluid" alt="Uploaded Image" style="border-radius: 2%; height: 200px; width: 40%;">
                <!-- File input -->
                <input type="file" id="imageInput1" name="blog_title_image" class="d-none">
              </div>
           
              <input type="text" class="form-control" id="blogTitle" name="blogTitle" placeholder="Enter your blog title" required>
              <input type="text" class="form-control" id="description" name="description" placeholder="Enter description of your blog" required>
              <input type="text" class="form-control" id="category" name="Category" placeholder="Category" required>
             
              <select class="form-control" id="userChoice" name="user_choice" required>
                <option value="" disabled selected>Select a user</option>
                {% for user in users %}
                  <option value="{{ user.id }}">{{ user.name}}</option>
                {% endfor %}

              </select>
            </div>
            <div id="editor"></div>
            <input type="hidden" id="hiddenContent" name="hiddenContent">
           {% csrf_token %}
            <button type="submit" id="saveButton" class="btn btn-primary" style="margin-top: 5%;margin-left: 20%; width: 50%;">Save</button>
          </form>
      
</div>
    
       
  <script>
     var quill = new Quill('#editor', {
    modules: {
        toolbar: [
            [{ header: [1, 2, false] }],
            ['bold', 'italic', 'underline', 'link'],
            [{ list: 'ordered' }, { list: 'bullet' }],
            ['image']
        ]
    },
    placeholder: 'Do some stuff here',
    theme: 'snow' // or 'bubble' for a more compact toolbar
});
quill.getModule('toolbar').addHandler('image', function() {
    var input = document.createElement('input');
    input.setAttribute('type', 'file');
    input.setAttribute('accept', 'image/*');
    input.click();

    input.onchange = function() {
        var file = input.files[0];
        if (file) {
            var reader = new FileReader();
            reader.onload = function() {
                var range = quill.getSelection();
                quill.insertEmbed(range.index, 'image', reader.result);
            };
            reader.readAsDataURL(file);
        }
    };
});
    
    const saveButton = document.getElementById('saveButton');
    const hiddenContentInput = document.getElementById('hiddenContent');

    saveButton.addEventListener('click', () => {
      const content = editor.root.innerHTML; // Get the HTML content from the editor
      // You can now send the 'content' to your server for saving or further processing
      console.log(content);
      hiddenContentInput.value = content
    });
    

        const myButton1 = document.getElementById('previewImage1');
        const Inputimage1 = document.getElementById('imageInput1');
    // Add a click event listener to the element
    myButton1.addEventListener('click', function() {
        const my= document.getElementById('imageInput1');
        console.log("it is clicked")
        my.click()
    
    });
    Inputimage1.addEventListener('change', function() {
      const file = this.files[0];
      const reader = new FileReader();
      reader.onload = function(e) {
        const previewImage1 = document.getElementById('previewImage1');
        previewImage1.src = e.target.result;
        previewImage1.style.display = 'block';
        previewImage1.style.marginLeft = '30%';
        console.log("its running")
      };
    reader.readAsDataURL(file);
        // Function to read and display the selected image
    
      });
   
    </script>
</body>
</html>
